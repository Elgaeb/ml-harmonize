<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Batch Detail</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet"
          href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
          crossorigin="anonymous"/>
    <link rel="stylesheet" th:href="@{/css/base.css}"/>
</head>
<body>
<header class="navbar navbar-expand-md fixed-top navbar-dark bg-dark">
    <a class="navbar-brand" href="#">MarkLogic Data Hub Job Explorer</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
            aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" th:href="@{/harmonize}">Harmonize</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/jobs}">Jobs</a>
            </li>
        </ul>
    </div>
</header>
<div class="container-fluid" th:if="${batch}">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a th:href="@{/jobs}">Jobs</a></li>
            <li class="breadcrumb-item"><a th:href="'/jobStatus?jobId=' + ${batch.jobId}" th:text="'Job ' + ${batch.jobId}">Job 12345</a></li>
            <li class="breadcrumb-item"><a th:href="'/stepStatus?jobId=' + ${batch.jobId} + '&stepNumber=' + ${batch.stepNumber}" th:text="'Step ' + ${batch.stepNumber}">Step 12345</a></li>
            <li class="breadcrumb-item active" aria-current="page" href="#" th:text="'Batch ' + ${batchId}">12345</li>
        </ol>
    </nav>

    <div class="row" th:if="${batch}">
        <div class="col-12">
            <form>
                <div class="row">
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="jobId">Job ID</label>
                            <input type="text" readonly class="form-control-plaintext" id="jobId" th:value="${batch.jobId}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="stepNumber">Step Number</label>
                            <input type="text" readonly class="form-control-plaintext" id="stepNumber" th:value="${batch.stepNumber}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="batchId">Batch ID</label>
                            <input type="text" readonly class="form-control-plaintext" id="batchId" th:value="${batch.batchId}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="batchStatus">Status</label>
                            <input type="text" readonly class="form-control-plaintext" id="batchStatus" th:value="${batch.batchStatus}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="timeStarted">Start Time</label>
                            <input type="text" readonly class="form-control-plaintext" id="timeStarted" th:value="${#temporals.format(batch.timeStarted, 'M/d/yyyy h:mm:ss a')}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="timeEnded">End Time</label>
                            <input type="text" readonly class="form-control-plaintext" id="timeEnded" th:value="${#temporals.format(batch.timeEnded, 'M/d/yyyy h:mm:ss a')}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="hostName">Host Name</label>
                            <input type="text" readonly class="form-control-plaintext" id="hostName" th:value="${batch.hostName}">
                        </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="reqTimeStamp">Request Timestamp</label>
                            <input type="text" readonly class="form-control-plaintext" id="reqTimeStamp" th:value="${#temporals.format(batch.reqTimeStamp, 'M/d/yyyy h:mm:ss a')}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="reqTrnxID">Request Transaction ID</label>
                            <input type="text" readonly class="form-control-plaintext" id="reqTrnxID" th:value="${batch.reqTrnxID}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="writeTimeStamp">Write Timestamp</label>
                            <input type="text" readonly class="form-control-plaintext" id="writeTimeStamp" th:value="${#temporals.format(batch.writeTimeStamp, 'M/d/yyyy h:mm:ss a')}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div class="form-group">
                            <label for="writeTrnxID">Write Transaction ID</label>
                            <input type="text" readonly class="form-control-plaintext" id="writeTrnxID" th:value="${batch.writeTrnxID}">
                        </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-12 col-xl-3 col-sm-6">
                        <div th:if="${batch.completeError}">
                            <label for="errorName">Error Name</label>
                            <input type="text" readonly class="form-control-plaintext" id="errorName" th:value="${batch.completeError.name}">
                        </div>
                    </div>
                    <div class="col-12 col-xl-9 col-sm-6">
                        <div th:if="${batch.completeError}">
                            <label for="errorMessage">Error Message</label>
                            <input type="text" readonly class="form-control-plaintext" id="errorMessage" th:value="${batch.completeError.message}">
                        </div>
                    </div>
                    <div class="w-100"></div>

                    <div class="col-12" th:if="${batch.completeError}">
                        <div class="accordion" id="errorStackAccordion" style="margin-bottom: 1em;">
                            <div class="card">
                                <div class="card-header" id="errorStackHeader">
                                    <h2 class="mb-0">
                                        <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#errorStack" aria-expanded="false" aria-controls="batchUris">
                                            Error Stack
                                        </button>
                                    </h2>
                                </div>

                                <div id="errorStack" class="collapse" aria-labelledby="headingOne" data-parent="#errorStackAccordion">
                                    <div class="card-body" style="white-space: pre-line; font-family: monospace;" th:text="${batch.completeError.stack}">
                                        Error Stack
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="w-100" th:if="${batch.uris}"></div>

                    <div class="col-12" th:if="${batch.uris}">
                        <div class="accordion" id="urisAccordion" style="margin-bottom: 1em;">
                            <div class="card">
                                <div class="card-header" id="documentUrisHeader">
                                    <h2 class="mb-0">
                                        <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#batchUris" aria-expanded="false" aria-controls="batchUris"
                                                th:text="'Document URIs (' + ${batch.uris.size()} + ')'"
                                        >
                                            Document URIs (12)
                                        </button>
                                    </h2>
                                </div>

                                <div id="batchUris" class="collapse" aria-labelledby="headingOne" data-parent="#urisAccordion">
                                    <div class="card-body">
                                        <div th:each="uri : ${batch.uris}" th:text="${uri}">/path/to/document.json</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="w-100" th:if="${batch.uris}"></div>

                </div>
            </form>
        </div>
    </div>
</div>

<div class="container" th:unless="${batch}">
    <div class="row">
        <div class="col">
            <div class="alert alert-warning" role="alert">
                No batch document was found for batch <span th:text="${batchId}">12345</span>.
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>
</body>
</html>